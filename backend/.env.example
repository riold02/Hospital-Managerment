# ============================================================================
# HOSPITAL MANAGEMENT SYSTEM - ENVIRONMENT CONFIGURATION
# Version: 2025.1.0
# Description: Complete configuration template for all services
# ============================================================================

# ============================================================================
# SERVER CONFIGURATION
# ============================================================================
NODE_ENV=development
PORT=3001

# ============================================================================
# DATABASE CONFIGURATION (PostgreSQL via Prisma)
# ============================================================================
DATABASE_URL=postgresql://postgres:postgres@postgres:5432/hospital?schema=public

# Database Security
DB_SSL_MODE=require
DB_CONNECTION_TIMEOUT=30000
DB_QUERY_TIMEOUT=10000

# ============================================================================
# AUTHENTICATION & JWT CONFIGURATION
# ============================================================================
JWT_SECRET=your-super-secure-jwt-secret-at-least-32-characters-long
JWT_EXPIRES_IN=24h
JWT_ALGORITHM=HS256

# Password Security
BCRYPT_ROUNDS=12
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SYMBOLS=false

# Session Security
SESSION_TIMEOUT=3600000
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION=900000

# ============================================================================
# CORS CONFIGURATION
# ============================================================================
CORS_ORIGIN=http://localhost:3000,http://localhost:3001,https://yourdomain.com
CORS_CREDENTIALS=true

# ============================================================================
# RATE LIMITING CONFIGURATION
# ============================================================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
AUTH_RATE_LIMIT_MAX=10
STRICT_RATE_LIMIT_MAX=5

# ============================================================================
# SECURITY HEADERS CONFIGURATION
# ============================================================================
HSTS_MAX_AGE=31536000
CSP_DEFAULT_SRC='self'
CSP_SCRIPT_SRC='self'
CSP_STYLE_SRC='self' 'unsafe-inline'

# IP Filtering (comma-separated, uncomment to enable)
# IP_WHITELIST=192.168.1.100,10.0.0.50
# IP_BLACKLIST=192.168.1.200,10.0.0.99

# Request Size Limits
MAX_REQUEST_SIZE=10485760
MAX_JSON_SIZE=10485760
MAX_URL_ENCODED_SIZE=10485760

# ============================================================================
# EMAIL CONFIGURATION (cho chức năng Forgot Password)
# ============================================================================

# Frontend URL (để tạo link reset password)
FRONTEND_URL=http://localhost:3000

# Email Configuration - Gmail (RECOMMENDED)
EMAIL_USER=your-email@gmail.com
EMAIL_PASSWORD=your-app-password-here

# Alternative SMTP Configuration (thay vì Gmail)
# SMTP_HOST=smtp.your-provider.com
# SMTP_PORT=587
# SMTP_SECURE=false
# SMTP_USER=your-smtp-user
# SMTP_PASSWORD=your-smtp-password

# Password Reset Configuration  
RESET_TOKEN_EXPIRE_MINUTES=30

# ============================================================================
# FILE UPLOAD SECURITY
# ============================================================================
UPLOAD_MAX_SIZE=5242880
ALLOWED_FILE_TYPES=jpg,jpeg,png,pdf,doc,docx
UPLOAD_SCAN_VIRUSES=false

# ============================================================================
# API SECURITY
# ============================================================================
API_VERSION_HEADER=X-API-Version
API_KEY_HEADER=X-API-Key
REQUIRE_API_KEY=false

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================
LOG_LEVEL=info
LOG_SECURITY_EVENTS=true
LOG_FAILED_LOGINS=true
LOG_VALIDATION_ERRORS=true

# ============================================================================
# DEVELOPMENT/PRODUCTION FLAGS
# ============================================================================
TRUST_PROXY=true
ENABLE_SWAGGER=true
ENABLE_CORS_DEBUG=false

# ============================================================================
# MONITORING & METRICS
# ============================================================================
ENABLE_METRICS=true
METRICS_PORT=9090
HEALTH_CHECK_TIMEOUT=5000

# ============================================================================
# THIRD-PARTY INTEGRATIONS (Optional)
# ============================================================================
SENTRY_DSN=
DATADOG_API_KEY=
NEW_RELIC_LICENSE_KEY=

# ============================================================================
# DOCKER COMPOSE VARIABLES (PostgreSQL & pgAdmin)
# ============================================================================
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=hospital

PGADMIN_EMAIL=admin@hospital.com
PGADMIN_PASSWORD=admin123

# ============================================================================
# SETUP INSTRUCTIONS
# ============================================================================

# 1. EMAIL SETUP (Gmail):
#    - Bật 2-Factor Authentication cho Gmail
#    - Tạo App Password: https://support.google.com/accounts/answer/185833
#    - Sử dụng App Password làm EMAIL_PASSWORD
#    - Có thể test với Mailtrap.io hoặc Ethereal Email

# 2. SECURITY SETUP:
#    - Thay đổi JWT_SECRET thành chuỗi ngẫu nhiên >= 32 ký tự
#    - Cập nhật CORS_ORIGIN với domain thực tế
#    - Thiết lập IP_WHITELIST/BLACKLIST nếu cần
#    - Bật SSL cho database trong production

# 3. PRODUCTION DEPLOYMENT:
#    - Đặt NODE_ENV=production
#    - Sử dụng DATABASE_URL với SSL
#    - Tắt ENABLE_SWAGGER=false
#    - Thiết lập monitoring tools (Sentry, Datadog, etc.)

# 4. TESTING:
#    - Có thể sử dụng các giá trị mặc định cho development
#    - Database sẽ tự động được tạo qua Docker Compose
#    - pgAdmin accessible tại http://localhost:5050

# ============================================================================
# SECURITY NOTES
# ============================================================================
# - KHÔNG commit file .env vào git
# - Sử dụng App Password thay vì password chính cho email
# - Token reset chỉ có hiệu lực trong thời gian ngắn (15-30 phút)
# - Rate limiting được áp dụng cho tất cả authentication endpoints
# - File upload được giới hạn loại và kích thước
# - Security headers được tự động thêm vào mọi response